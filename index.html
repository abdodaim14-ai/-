<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>منصة القراء المحترفين 2026 - الربط الذكي</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&family=Amiri:wght@400;700&family=Almarai:wght@300;400;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>

    <style>
        :root {
            --gold: #ffcc33;
            --bg-dark: #020617;
            --glass: rgba(15, 23, 42, 0.97);
        }

        body {
            background-color: var(--bg-dark);
            color: #fff;
            font-family: 'Almarai', sans-serif;
            background-image: radial-gradient(circle at top, #1e293b, #020617);
            min-height: 100vh;
        }

        .container { width: 95%; max-width: 1000px; margin: 0 auto; padding: 20px; }

        /* الساعة واللوجو */
        .header-box { text-align: center; margin-bottom: 40px; }
        .clock { font-size: 3rem; color: var(--gold); font-family: 'Cairo'; font-weight: 900; }
        .logo { width: 300px; filter: drop-shadow(0 0 20px var(--gold)); margin: 20px 0; }

        /* كارت البيانات */
        .mega-card {
            background: var(--glass);
            border-radius: 30px;
            padding: 40px;
            border: 2px solid var(--gold);
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
        }

        .section-title {
            color: var(--gold);
            font-family: 'Cairo';
            font-size: 1.8rem;
            margin-bottom: 30px;
            border-bottom: 2px solid var(--gold);
            display: inline-block;
        }

        .form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }

        .input-group { margin-bottom: 20px; }
        .input-group label { display: block; color: var(--gold); margin-bottom: 10px; font-weight: bold; }
        
        .styled-input {
            width: 100%;
            padding: 15px;
            background: #000;
            border: 2px solid #2d3748;
            border-radius: 12px;
            color: #fff;
            font-size: 1.1rem;
        }

        /* بوكس عرض الآية المربوط أوتوماتيكياً */
        .aya-preview-box {
            background: rgba(255, 204, 51, 0.05);
            border-right: 5px solid var(--gold);
            padding: 20px;
            margin-top: 10px;
            border-radius: 0 15px 15px 0;
            font-family: 'Amiri', serif;
            font-size: 1.4rem;
            line-height: 2;
            color: #e2e8f0;
            min-height: 60px;
        }

        .page-badge {
            display: inline-block;
            background: var(--gold);
            color: #000;
            padding: 5px 15px;
            border-radius: 10px;
            font-weight: bold;
            font-size: 0.9rem;
            margin-top: 10px;
        }

        /* أزرار الرفع */
        .upload-area { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 30px; }
        
        .upload-btn {
            height: 200px;
            border: 3px dashed var(--gold);
            border-radius: 20px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            position: relative;
            overflow: hidden;
            background: rgba(255,204,51,0.02);
        }

        .upload-btn i { font-size: 3rem; color: var(--gold); margin-bottom: 10px; }
        
        .preview-img { position: absolute; inset: 0; width: 100%; height: 100%; object-fit: cover; display: none; }
        
        .audio-player { width: 90%; display: none; margin-top: 10px; }

        .submit-btn {
            width: 100%;
            padding: 25px;
            background: var(--gold);
            border: none;
            border-radius: 50px;
            font-size: 2rem;
            font-weight: 900;
            margin-top: 30px;
            cursor: pointer;
            color: #000;
            font-family: 'Cairo';
        }

        #loading {
            display: none; position: fixed; inset: 0; background: #000; z-index: 100;
            flex-direction: column; justify-content: center; align-items: center;
        }

        @media (max-width: 768px) { .form-grid, .upload-area { grid-template-columns: 1fr; } }
    </style>
</head>
<body>

<div id="loading">
    <div style="font-size: 5rem; color: var(--gold); font-weight: 900;" id="load-perc">0%</div>
    <div id="load-msg" style="font-size: 1.5rem; text-align: center; padding: 20px; font-family: 'Amiri';"></div>
</div>

<div class="container animate__animated animate__fadeIn">
    
    <div class="header-box">
        <div class="clock" id="clock">00:00:00</div>
        <img src="https://i.postimg.cc/0yZxfgx2/Picsart-26-01-13-17-01-28-072.png" class="logo">
        <h1 style="font-family: 'Amiri'; font-size: 3rem; color: var(--gold);">﴿ وَرَتِّلِ الْقُرْآنَ تَرْتِيلًا ﴾</h1>
    </div>

    <div class="mega-card">
        <h2 class="section-title">بيانات القارئ والمقطع</h2>
        
        <form id="pro-form">
            <div class="input-group">
                <label>الاسم الكامل</label>
                <input type="text" class="styled-input" placeholder="اكتب اسمك الثلاثي" required>
            </div>

            <div class="form-grid">
                <div class="input-group">
                    <label>السورة</label>
                    <select id="sura-select" class="styled-input" onchange="initSura()"></select>
                </div>
                <div class="input-group">
                    <label>رقم الواتساب</label>
                    <input type="tel" class="styled-input" placeholder="+20">
                </div>
            </div>

            <div class="form-grid">
                <div class="input-group">
                    <label>من آية</label>
                    <select id="aya-from" class="styled-input" onchange="fetchAya('from')"></select>
                    <div id="preview-from" class="aya-preview-box">نص الآية سيظهر هنا...</div>
                    <div id="page-from" class="page-badge">صفحة: --</div>
                </div>
                <div class="input-group">
                    <label>إلى آية</label>
                    <select id="aya-to" class="styled-input" onchange="fetchAya('to')"></select>
                    <div id="preview-to" class="aya-preview-box">نص الآية سيظهر هنا...</div>
                    <div id="page-to" class="page-badge">صفحة: --</div>
                </div>
            </div>

            <div class="upload-area">
                <div class="upload-btn" onclick="document.getElementById('in-img').click()">
                    <div id="img-label"><i class="fas fa-user-circle"></i><br>صورة القارئ</div>
                    <img id="img-view" class="preview-img">
                    <input type="file" id="in-img" hidden accept="image/*" onchange="handleImg(this)">
                </div>
                <div class="upload-btn" onclick="document.getElementById('in-aud').click()">
                    <div id="aud-label"><i class="fas fa-microphone-alt"></i><br>ملف الصوت</div>
                    <audio id="aud-view" controls class="audio-player"></audio>
                    <input type="file" id="in-aud" hidden accept="audio/*" onchange="handleAud(this)">
                </div>
            </div>

            <button type="submit" class="submit-btn">إرسال التلاوة للمراجعة</button>
        </form>
    </div>
</div>

<script>
    // قائمة السور
    const SURAS = [["الفاتحة", 7, 1], ["البقرة", 286, 2], ["آل عمران", 200, 3], ["النساء", 176, 4], ["المائدة", 120, 5], ["الأنعام", 165, 6], ["الأعراف", 206, 7]]; // كمل باقي السور بنفس النمط
    const sSelect = document.getElementById('sura-select');
    SURAS.forEach((s, index) => sSelect.add(new Option(s[0], s[2])));

    function initSura() {
        const suraNum = sSelect.value;
        const count = SURAS.find(x => x[2] == suraNum)[1];
        const f = document.getElementById('aya-from'), t = document.getElementById('aya-to');
        f.innerHTML = ''; t.innerHTML = '';
        for(let i=1; i<=count; i++) {
            f.add(new Option(i, i));
            t.add(new Option(i, i));
        }
        fetchAya('from'); fetchAya('to');
    }

    // الربط الذكي بالـ API لجلب النص ورقم الصفحة أوتوماتيك
    async function fetchAya(type) {
        const suraNum = sSelect.value;
        const ayaNum = document.getElementById(`aya-${type}`).value;
        const preview = document.getElementById(`preview-${type}`);
        const pageBadge = document.getElementById(`page-${type}`);

        preview.innerText = "جاري جلب الآية...";
        
        try {
            const res = await fetch(`https://api.alquran.cloud/v1/ayah/${suraNum}:${ayaNum}/ar.medina`);
            const data = await res.json();
            if(data.status === "OK") {
                preview.innerText = data.data.text;
                pageBadge.innerText = "صفحة: " + data.data.page;
            }
        } catch(e) {
            preview.innerText = "خطأ في الاتصال.. تأكد من اختيار السورة";
        }
    }

    function handleImg(input) {
        if(input.files[0]) {
            const r = new FileReader();
            r.onload = e => { 
                document.getElementById('img-view').src = e.target.result;
                document.getElementById('img-view').style.display = 'block';
                document.getElementById('img-label').style.display = 'none';
            }
            r.readAsDataURL(input.files[0]);
        }
    }

    function handleAud(input) {
        if(input.files[0]) {
            document.getElementById('aud-view').src = URL.createObjectURL(input.files[0]);
            document.getElementById('aud-view').style.display = 'block';
            document.getElementById('aud-label').style.display = 'none';
        }
    }

    // تشغيل الساعة والبدء
    setInterval(() => { document.getElementById('clock').innerText = new Date().toLocaleTimeString('ar-EG'); }, 1000);
    initSura();

    // الإرسال
    document.getElementById('pro-form').onsubmit = function(e) {
        e.preventDefault();
        document.getElementById('loading').style.display = 'flex';
        let p = 0;
        const int = setInterval(() => {
            if(p < 100) {
                p++;
                document.getElementById('load-perc').innerText = p + "%";
                document.getElementById('load-msg').innerText = "جاري معالجة تلاوتك وربطها بالمصحف الشريف...";
            } else {
                clearInterval(int);
                alert("تم استلام تلاوتك بنجاح! سيتم مراجعة المقطع ونشره قريباً.");
                location.reload();
            }
        }, 100);
    }
</script>

</body>
</html>
