<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>داعم المواهب للقرآن الكريم | احترافية رقمية</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@700;900&family=Almarai:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/css/intlTelInput.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>

    <style>
        :root { 
            --gold: #ffcc33; 
            --gold-dark: #b8860b;
            --gold-glow: rgba(255, 204, 51, 0.4);
            --bg-dark: #050505;
            --card-bg: rgba(20, 20, 20, 0.85);
        }

        body {
            font-family: 'Almarai', sans-serif;
            margin: 0; color: #fff; background: var(--bg-dark);
            overflow-x: hidden;
            min-height: 100vh;
        }

        /* خلفية النجوم المتحركة المتطورة */
        #bg-canvas {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            z-index: -1; background: radial-gradient(circle at center, #111 0%, #000 100%);
        }

        .container { 
            width: 92%; max-width: 550px; margin: auto; 
            padding: 40px 0 140px; position: relative; z-index: 10; 
        }

        /* الهيدر الاحترافي */
        .logo-container { position: relative; display: inline-block; }
        .logo-main { 
            width: 140px; filter: drop-shadow(0 0 20px var(--gold-glow));
            animation: float 4s ease-in-out infinite;
        }
        @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-15px); } }

        .site-name { 
            font-family: 'Cairo'; color: var(--gold); font-size: 1.6rem; 
            text-transform: uppercase; letter-spacing: 1px; margin-top: 15px;
            text-shadow: 0 0 15px var(--gold-glow);
        }

        /* البطاقات الزجاجية (Glassmorphism) */
        .glass-card {
            background: var(--card-bg);
            border: 1px solid rgba(255, 204, 51, 0.2);
            border-radius: 30px;
            padding: 30px;
            backdrop-filter: blur(15px);
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
            margin-bottom: 30px;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .glass-card:hover { 
            transform: translateY(-5px); 
            border-color: var(--gold);
            box-shadow: 0 25px 60px rgba(255, 204, 51, 0.1);
        }

        /* العدادات */
        .info-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .stat-box { text-align: center; border-right: 1px solid rgba(255,204,51,0.2); }
        .stat-box:last-child { border: none; }
        .stat-val { font-size: 1.4rem; color: var(--gold); font-weight: 900; display: block; }
        .stat-label { font-size: 0.8rem; color: #aaa; }

        /* مشغل الفيديو */
        .video-wrapper {
            position: relative; border-radius: 20px; overflow: hidden;
            border: 2px solid var(--gold); box-shadow: 0 0 30px var(--gold-glow);
        }
        .video-wrapper iframe { width: 100%; aspect-ratio: 16/9; border: none; }

        /* فورم التقديم */
        .field-group { position: relative; margin-bottom: 20px; text-align: right; }
        .field-group label { color: var(--gold); font-size: 0.9rem; font-weight: 700; margin-bottom: 8px; display: block; }
        .input-style {
            width: 100%; background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,204,51,0.2);
            padding: 14px 45px 14px 15px; border-radius: 15px;
            color: #fff; outline: none; transition: 0.3s; box-sizing: border-box;
        }
        .input-style:focus { border-color: var(--gold); background: rgba(255,204,51,0.05); }
        .field-icon { position: absolute; right: 15px; top: 40px; color: var(--gold); opacity: 0.7; }

        /* أزرار الرفع */
        .upload-btn {
            border: 2px dashed rgba(255,204,51,0.3); border-radius: 15px;
            padding: 20px; cursor: pointer; transition: 0.3s; text-align: center;
        }
        .upload-btn:hover { background: rgba(255,204,51,0.1); border-style: solid; }
        .upload-btn i { font-size: 2rem; color: var(--gold); margin-bottom: 10px; }

        /* الزر الرئيسي */
        .shiny-btn {
            width: 100%; padding: 20px; border-radius: 50px;
            background: linear-gradient(45deg, var(--gold-dark), var(--gold));
            color: #000; font-weight: 900; border: none; cursor: pointer;
            font-size: 1.2rem; transition: 0.4s;
            box-shadow: 0 10px 20px var(--gold-glow);
        }
        .shiny-btn:hover { transform: scale(1.02); box-shadow: 0 15px 30px var(--gold); }

        /* فوتر الاتصال */
        .call-btn-fixed {
            position: fixed; bottom: 25px; left: 50%; transform: translateX(-50%);
            width: 90%; max-width: 450px; background: rgba(0,0,0,0.9);
            border: 1px solid var(--gold); border-radius: 50px; padding: 15px;
            z-index: 1000; display: flex; align-items: center; justify-content: center;
            gap: 15px; text-decoration: none; backdrop-filter: blur(10px);
        }

        /* شاشة التحميل */
        #loadingOverlay {
            position: fixed; inset: 0; background: #000; z-index: 10000;
            display: none; flex-direction: column; align-items: center; justify-content: center;
        }
        .quran-loader { font-size: 4rem; color: var(--gold); animation: pulse 2s infinite; }
        @keyframes pulse { 0% { opacity: 0.5; } 50% { opacity: 1; text-shadow: 0 0 30px var(--gold); } 100% { opacity: 0.5; } }
    </style>
</head>
<body>

<canvas id="bg-canvas"></canvas>

<div id="loadingOverlay">
    <div id="progressText" style="font-size: 4rem; color: var(--gold); font-weight: 900; font-family: 'Cairo';">0%</div>
    <div class="quran-loader"><i class="fas fa-quran"></i></div>
    <div id="quizBox" class="glass-card" style="max-width: 350px; margin-top: 30px; text-align: center;">
        <div id="quizQ" style="color: var(--gold); font-weight: bold; margin-bottom: 10px;">نور على نور..</div>
        <div id="quizA" style="font-size: 0.9rem; line-height: 1.6;">جاري تحضير تلاوتكم للعالمين</div>
    </div>
</div>

<div class="container animate__animated animate__fadeIn">
    
    <header style="text-align: center; margin-bottom: 40px;">
        <div class="logo-container">
            <img src="https://i.postimg.cc/0yZxfgx2/Picsart-26-01-13-17-01-28-072.png" class="logo-main">
        </div>
        <h1 class="site-name">داعم المواهب للقرآن الكريم</h1>
        <div class="quran-verse" style="font-family: 'Cairo'; font-size: 2rem; margin-top: 10px;">وَرَتِّلِ الْقُرْآنَ تَرْتِيلًا</div>
    </header>

    <div class="glass-card info-grid">
        <div class="stat-box">
            <i class="fas fa-history" style="color: var(--gold); margin-bottom: 5px;"></i>
            <span id="liveTime" class="stat-val">00:00:00</span>
            <span id="combinedDate" class="stat-label">-- -- ----</span>
        </div>
        <div class="stat-box">
            <i class="fas fa-award" style="color: var(--gold); margin-bottom: 5px;"></i>
            <span id="userCounter" class="stat-val">13</span>
            <span class="stat-label">موهبة قرآنية مسجلة</span>
        </div>
    </div>

    <div class="glass-card" style="padding: 15px;">
        <p style="text-align: center; color: var(--gold); font-weight: bold; margin-bottom: 10px;">✨ أصوات هزت القلوب ✨</p>
        <div class="video-wrapper">
            <iframe src="https://www.youtube.com/embed/LeUouzj6wns" allowfullscreen></iframe>
        </div>
    </div>

    <div class="glass-card">
        <h3 style="text-align: center; color: var(--gold); font-family: 'Cairo'; margin-bottom: 25px;">سجل موهبتك الآن</h3>
        <form id="talentForm">
            <div class="field-group">
                <label>الاسم الكامل</label>
                <i class="fas fa-user field-icon"></i>
                <input type="text" id="name" class="input-style" required placeholder="مثال: عبد الرحمن مكي">
            </div>

            <div class="field-group">
                <label>رقم الواتساب</label>
                <input type="tel" id="phone" class="input-style" required>
            </div>

            <div class="field-group">
                <label>اختر السورة</label>
                <i class="fas fa-book-open field-icon" style="top: 45px;"></i>
                <select id="surah" class="input-style" style="padding-right: 45px;" required onchange="fillQuranData()">
                    <option value="" disabled selected>تحديد السورة..</option>
                </select>
            </div>

            <div class="info-grid">
                <div class="field-group">
                    <label>من آية</label>
                    <select id="ayahFrom" class="input-style" required onchange="smartPageLink('from')"></select>
                </div>
                <div class="field-group">
                    <label>إلى آية</label>
                    <select id="ayahTo" class="input-style" required onchange="smartPageLink('to')"></select>
                </div>
            </div>

            <div class="upload-grid" style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 25px;">
                <div class="upload-btn" onclick="document.getElementById('imgIn').click()">
                    <i class="fas fa-id-badge"></i>
                    <p id="imgT" style="font-size: 0.8rem; margin: 0;">ارفق صورتك</p>
                    <input type="file" id="imgIn" accept="image/*" style="display:none" required onchange="up(this,'imgT')">
                </div>
                <div class="upload-btn" onclick="document.getElementById('fileIn').click()">
                    <i class="fas fa-microphone-lines"></i>
                    <p id="fileT" style="font-size: 0.8rem; margin: 0;">ارفق التلاوة</p>
                    <input type="file" id="fileIn" accept="audio/*" style="display:none" required onchange="audioUp(this)">
                </div>
            </div>

            <button type="submit" class="shiny-btn">إرسال التلاوة للمراجعة <i class="fas fa-paper-plane"></i></button>
        </form>
    </div>

    <div style="text-align: center;">
        <div style="display: flex; justify-content: center; gap: 20px;">
            <a href="https://youtube.com/@abdomaki17" target="_blank" class="s-box" style="width: 50px; height: 50px; border-radius: 50%; border: 1px solid var(--gold); display: flex; align-items: center; justify-content: center; color: var(--gold); text-decoration: none;"><i class="fab fa-youtube"></i></a>
            <a href="https://www.facebook.com/share/18aVe6P3xy/" target="_blank" class="s-box" style="width: 50px; height: 50px; border-radius: 50%; border: 1px solid var(--gold); display: flex; align-items: center; justify-content: center; color: var(--gold); text-decoration: none;"><i class="fab fa-facebook-f"></i></a>
        </div>
        <p style="color: #888; font-size: 0.8rem; margin-top: 20px;">خادم القرآن الكريم/ عبد الرحمن مكي</p>
    </div>
</div>

<a href="tel:01122783768" class="call-btn-fixed">
    <i class="fas fa-phone-alt animate__animated animate__tada animate__infinite" style="color: var(--gold);"></i>
    <span style="color: #fff; font-family: 'Cairo'; font-size: 0.9rem;">هل لديك استفسار؟ تواصل معنا</span>
</a>

<script src="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/js/intlTelInput.min.js"></script>
<script>
    // --- برمجة الخلفية التفاعلية ---
    const canvas = document.getElementById('bg-canvas');
    const ctx = canvas.getContext('2d');
    let particles = [];
    
    function initCanvas() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
    }
    window.addEventListener('resize', initCanvas);
    initCanvas();

    class Particle {
        constructor() {
            this.x = Math.random() * canvas.width;
            this.y = Math.random() * canvas.height;
            this.size = Math.random() * 2;
            this.speedX = Math.random() * 0.5 - 0.25;
            this.speedY = Math.random() * 0.5 - 0.25;
        }
        update() {
            this.x += this.speedX;
            this.y += this.speedY;
            if (this.x > canvas.width) this.x = 0;
            if (this.x < 0) this.x = canvas.width;
            if (this.y > canvas.height) this.y = 0;
            if (this.y < 0) this.y = canvas.height;
        }
        draw() {
            ctx.fillStyle = 'rgba(255, 204, 51, 0.3)';
            ctx.beginPath();
            ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
            ctx.fill();
        }
    }

    function createParticles() {
        for (let i = 0; i < 100; i++) particles.push(new Particle());
    }
    createParticles();

    function animateParticles() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        particles.forEach(p => { p.update(); p.draw(); });
        requestAnimationFrame(animateParticles);
    }
    animateParticles();

    // --- بقية المنطق البرمجي الخاص بك (بدون تغيير) ---
    const scriptURL = 'https://script.google.com/macros/s/AKfycbyFuMa99FTBcykVxdxd_0Stn2mQqeb9vE5ArZY39kQCyXNaALYcXsg5plbdpbjlUmXhsQ/exec';
    
    const GET_COUNTER_API = 'https://api.countapi.xyz/get/quran-talent-abdomaki/submissions';

    async function updateGlobalCounter() {
        try {
            const res = await fetch(GET_COUNTER_API);
            const data = await res.json();
            document.getElementById('userCounter').innerText = (13 + (data.value || 0)).toLocaleString('ar-EG');
        } catch (e) { document.getElementById('userCounter').innerText = '13'; }
    }

    function initLiveInfo() {
        const updateClock = () => {
            const now = new Date();
            document.getElementById('liveTime').innerText = now.toLocaleTimeString('ar-EG');
            const hijri = new Intl.DateTimeFormat('ar-SA-u-ca-islamic-umalqura-nu-latn', {day:'numeric', month:'long', year:'numeric'}).format(now);
            document.getElementById('combinedDate').innerText = hijri;
        };
        updateClock();
        setInterval(updateClock, 1000);
        updateGlobalCounter();
    }
    initLiveInfo();

    // قريطة السور
    const quranMap = [["الفاتحة",7,1],["البقرة",286,2],["آل عمران",200,50],["النساء",176,77],["المائدة",120,106],["الأنعام",165,128],["الأعراف",206,151],["الأنفال",75,177],["التوبة",129,187],["يونس",109,208],["هود",123,221],["يوسف",111,235],["الرعد",43,249],["إبراهيم",52,255],["الحجر",99,262],["النحل",128,267],["الإسراء",111,282],["الكهف",110,293],["مريم",98,305],["طه",135,312],["الأنبياء",112,322],["الحج",78,332],["المؤمنون",118,342],["النور",64,350],["الفرقان",77,359],["الشعراء",227,367],["النمل",93,377],["القصص",88,385],["العنكبوت",69,396],["الروم",60,404],["لقمان",34,411],["السجدة",30,415],["الأحزاب",73,418],["سبأ",54,428],["فاطر",45,434],["يس",83,440],["الصافات",182,446],["ص",88,453],["الزمر",75,458],["غافر",85,467],["فصلت",54,477],["الشورى",53,483],["الزخرف",89,489],["الدخان",59,496],["الجاثية",37,499],["الأحقاف",35,502],["محمد",38,507],["الفتح",29,511],["الحجرات",18,515],["ق",45,518],["الذاريات",60,520],["الطور",49,523],["النجم",62,526],["القمر",55,528],["الرحمن",78,531],["الواقعة",96,534],["الحديد",29,537],["المجادلة",22,542],["الحشر",24,545],["الممتحنة",13,549],["الصف",14,551],["الجمعة",11,553],["المنافقون",11,554],["التغابن",18,556],["الطلاق",12,558],["التحريم",12,560],["الملك",30,562],["القلم",52,564],["الحاقة",52,566],["المعارج",44,568],["نوح",28,570],["الجن",28,572],["المزمل",20,574],["المدثر",56,575],["القيامة",40,577],["الإنسان",31,578],["المرسلات",50,580],["النبأ",40,582],["النازعات",46,583],["عبس",42,585],["التكوير",29,586],["الانفطار",19,587],["المطففين",36,587],["الانشقاق",25,589],["البروج",22,590],["الطارق",17,591],["الأعلى",19,591],["الغاشية",26,592],["الفجر",30,593],["البلد",20,594],["الشمس",15,595],["الليل",21,595],["الضحى",11,596],["الشرح",8,596],["التين",8,597],["العلق",19,597],["القدر",5,598],["البينة",8,598],["الزلزلة",8,599],["العاديات",11,599],["القارعة",11,600],["التكاثر",8,600],["العصر",3,601],["الهمزة",9,601],["الفيل",5,601],["قريش",4,602],["الماعون",7,602],["الكوثر",3,602],["الكافرون",6,603],["النصر",3,603],["المسد",5,603],["الإخلاص",4,604],["الفلق",5,604],["الناس",6,604]];

    const surahSelect = document.getElementById('surah');
    quranMap.forEach(s => { let opt = new Option(s[0], s[0]); surahSelect.add(opt); });

    function fillQuranData() {
        const selected = quranMap.find(s => s[0] === surahSelect.value);
        const [name, ayahs] = selected;
        const populate = (id, max) => {
            const el = document.getElementById(id); el.innerHTML = "";
            for(let i=1; i<=max; i++) { el.add(new Option(i, i)); }
        };
        populate('ayahFrom', ayahs); populate('ayahTo', ayahs);
    }

    const phoneInput = document.querySelector("#phone");
    const iti = window.intlTelInput(phoneInput, {
        initialCountry: "auto",
        separateDialCode: true,
        utilsScript: "https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/js/utils.js",
    });

    function up(i, id) { if(i.files[0]) document.getElementById(id).innerHTML = "✅ تم اختيار الصورة"; }
    function audioUp(i) { if(i.files[0]) document.getElementById('fileT').innerHTML = "✅ تم اختيار الصوت"; }

    document.getElementById('talentForm').onsubmit = async function(e) {
        e.preventDefault();
        const overlay = document.getElementById('loadingOverlay');
        const progText = document.getElementById('progressText');
        overlay.style.display = 'flex';
        
        try {
            const photoBase64 = await toBase64(document.getElementById('imgIn').files[0]);
            const audioBase64 = await toBase64(document.getElementById('fileIn').files[0]);
            
            const formData = new URLSearchParams();
            formData.append("Name", document.getElementById('name').value);
            formData.append("Phone", iti.getNumber());
            formData.append("Surah", document.getElementById('surah').value);
            formData.append("AyahFrom", document.getElementById('ayahFrom').value);
            formData.append("AyahTo", document.getElementById('ayahTo').value);
            formData.append("photoData", photoBase64.split(',')[1]);
            formData.append("audioData", audioBase64.split(',')[1]);

            let p = 0;
            const pInt = setInterval(() => { if(p < 95) { p += 1; progText.innerText = p + "%"; } }, 150);

            await fetch(scriptURL, { method: 'POST', mode: 'no-cors', body: formData });
            
            progText.innerText = "100%";
            setTimeout(() => { alert("تم استلام تلاوتكم بنجاح! نفع الله بكم."); location.reload(); }, 1000);

        } catch (err) { 
            overlay.style.display = 'none'; 
            alert("حدث خطأ، تأكد من حجم الملفات والإنترنت."); 
        }
    };

    const toBase64 = file => new Promise((resolve, reject) => {
        const reader = new FileReader();
        reader.readAsDataURL(file);
        reader.onload = () => resolve(reader.result);
        reader.onerror = error => reject(error);
    });
</script>
</body>
</html>
